# .zsh_darwin - macOS-specific interactive shell configuration
# Sourced from .zshrc for interactive shells only

# Kiro CLI integration (macOS only) - Keep at the top
[[ -f "${HOME}/Library/Application Support/kiro-cli/shell/zshrc.pre.zsh" ]] && builtin source "${HOME}/Library/Application Support/kiro-cli/shell/zshrc.pre.zsh"

# Brazil aliases (macOS-specific due to Brazil tooling)
alias bb="brazil-build"
alias bws="brazil workspace"
alias bmg='bemol --generate-vscode-ws $(basename $PWD).code-workspace'

# Remote build aliases (Amazon-specific, macOS only)
alias rbb="remote-build amazon"                    # Remote brazil-build
alias rbbt="remote-build amazon brazil-build test" # Remote brazil-build test
alias rbbr="remote-build amazon"                   # Remote brazil-build release (default)

# AWS CLI completion (zsh) - compinit/bashcompinit already loaded in .zshrc
if command -v aws_completer >/dev/null 2>&1; then
    complete -C aws_completer aws
fi

# Amazon credentials setup (macOS work machine only)
setup-credentials() {
    kinit
    mwinit -s
    ssh-add
    ssh clouddesk -t 'kinit -f && mwinit -s -o && ssh-add'
    ada cred update --once
    aws codeartifact login --region us-west-2 --tool npm --domain amazon --repository shared

    # Start Unison sync with Amazon cloud desktop in background
    echo "Starting Unison sync with Amazon cloud desktop..."
    remote-sync amazon &
    disown
}

# Kiro CLI integration (macOS only) - Keep at the bottom
[[ -f "${HOME}/Library/Application Support/kiro-cli/shell/zshrc.post.zsh" ]] && builtin source "${HOME}/Library/Application Support/kiro-cli/shell/zshrc.post.zsh"
